import pandas as pdimport numpy as npfrom matplotlib import pyplot as plt plt.rcParams['font.family'] =['SimHei']import pandas as pdimport numpy as npfrom matplotlib import pyplot as plt plt.rcParams['font.family'] =['SimHei']mask_data_clean = pd.read_csv('./Desktop/仨稻2021.1.1.csv',encoding='gbk')# 查看my_datamask_data_clean# 获取每月销售额总数sales_income = mask_data_clean.groupby(['日期', '推广计划'], as_index=False).agg({ '花费(元)': 'sum'})sales_incomecost = sales_income[sales_income['日期'].isin(['2021/4/24'])]cost1 = round(cost['花费(元)'].sum())print(cost1)mask_data_clean = pd.read_csv('./Desktop/仨稻2021.4.24.csv', encoding='utf-8')# 查看my_datagrouped_data_volume = mask_data_clean.groupby(['商品', '商品规格','商品总价(元)'], as_index=False).agg({'发货时间': 'max','商品数量(件)': 'count', '商家实收金额(元)': 'sum'})print(grouped_data_volume)volume = round(grouped_data_volume['商家实收金额(元)'].sum())print( volume)lst1 = grouped_data_volume['商品总价(元)'].valueslst2 = grouped_data_volume['商品数量(件)'].valueslst5 = grouped_data_volume['商品规格'].valuesdic = {}for i in range(len(lst1)):  #第一种方法    dic[lst1[i]] = lst2[i]A = dicmask_data = pd.read_csv('./Desktop/2021.11.12.csv', encoding='gbk')# 查看my_datalst3 = mask_data['商品总价(元)'].valueslst4 = mask_data['拼单成本'].valuesdic = {}for i in range(len(lst3)):  #第一种方法    dic[lst3[i]] = lst4[i]B = dicC = {}for key in list(set(A) | set(B)):    if A.get(key) and B.get(key):         C.update({key: A.get(key) * B.get(key)})cost2 = sum(C.values())print(C.values())print(cost2)print(A)print(B)profit = round(volume - cost1 -cost2)print(profit)data_dic = {'商品规格': lst5,'数量': lst2,'商品总价': lst1}data = pd.DataFrame(data_dic)print( data )data.to_excel('./Desktop/5.xlsx')